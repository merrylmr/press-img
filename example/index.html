<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>img press</title>
</head>
<body>
<div>
    <input
            type="file"
            placeholder="请上传图片"
            id="file">
</div>
<script src="../dist/main.js"></script>
<script>
    window.addEventListener('load', function () {
        const fileDom = document.getElementById('file');
        fileDom.addEventListener('change', function (e) {
            console.log('e', e.target.files);
            const file = e.target.files[0]

            const options = {
                file: file,
                quality: 0.5,
                mimeType: 'image/jpeg',
                width: 1000,

                beforeCompress: function (result, op) {
                    console.log('压缩之前的大小：', result.size);
                    console.log('mime 类型：', result.type, file.type, op);
                    // 修改压缩之后的类型
                    op.mimeType = file.type
                    // SimpleImageCompressor.file2DataUrl(result, function (url) {
                    //     console.log('url', url)
                    // })
                },
                success: function (result) {
                    console.log('success', result)
                    console.log('压缩之后的大小', result.size);
                    console.log('压缩率', (100 - result.size / file.size * 100).toFixed(2) + '%');
                    // 压缩成功之后，可以上传到服务器上
                    SimpleImageCompressor.blob2DataUrl(result, function (res) {
                        console.log('blob2DataUrl res', res);
                    });

                },
            }
            new SimpleImageCompressor(options)
        }, false)
    })
</script>
</body>
</html>